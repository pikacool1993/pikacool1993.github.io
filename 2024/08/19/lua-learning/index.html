<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="baidu-site-verification" content="vvVgSQUzPU" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1"
    />
    <meta name="keywords" content="pikacool|博客|个人|">
    <meta name="description" content="雄关漫道真如铁 而今迈步从头越">
    
    <title>
       Lua边学边记 -  pikacool
    </title>
    
<link rel="stylesheet" href="/css/style.css">
 
    
      <link rel="icon" href="/images/favicon.ico" />
    
  </head>
  <body>
    <div id="container">
      <div id="main-left">
        <div id="introduce">
          <div class="logo-worp">
            <a href="/"><img class="logo" src="/images/logo.png" alt=""/></a>
          </div>
          <ul>
            
              <li><a href="/"> Home </a></li>
            
              <li><a href="/archives"> Archive </a></li>
            
              <li><a href="/about"> About </a></li>
            
            <li>
              <img id="search-img" src="/images/search.svg" alt="search" />
            </li>
          </ul>
           
            <ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Lua%E8%AF%AD%E6%B3%95"><span class="post-toc-number">1.</span> <span class="post-toc-text">Lua语法</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E5%8F%98%E9%87%8F"><span class="post-toc-number">1.1.</span> <span class="post-toc-text">变量</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1"><span class="post-toc-number">1.2.</span> <span class="post-toc-text">面向对象</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%89%B9%E5%BE%81"><span class="post-toc-number">1.2.1.</span> <span class="post-toc-text">面向对象特征</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#%E7%A4%BA%E4%BE%8B"><span class="post-toc-number">1.2.2.</span> <span class="post-toc-text">示例</span></a></li></ol></li></ol></li></ol> 
          
        </div>
      </div>
      <div id="main-right"><div id="post">
    
    <header class="article-header">
        <h1>
            Lua边学边记
        </h1>
    </header>
    
    <div class="post-meta">
        <time class="post-data" datetime="2024-08-19T01:58:57.000Z" itemprop="datePublished">
            2024-08-19
        </time>
        
        
    </div>
    
    <div class="post-entry">
        <h2 id="Lua语法"><a href="#Lua语法" class="headerlink" title="Lua语法"></a><code>Lua</code>语法</h2><h3 id="变量"><a href="#变量" class="headerlink" title="变量"></a>变量</h3><p>简单4中变量类型</p>
<ul>
<li><p><code>number</code></p>
<p>表示双精度类型的实浮点数</p>
</li>
<li><p><code>string</code></p>
<p>字符串由一对双引号或单引号来表示</p>
</li>
<li><p><code>boolean</code></p>
<p>包含两个值：<code>false</code> 和 <code>true</code>。</p>
</li>
<li><p><code>nil</code></p>
</li>
</ul>
<p>复杂4种变量类型</p>
<ul>
<li><p><code>function</code> 函数</p>
<p>由 <code>C</code> 或 <code>Lua</code> 编写的函数</p>
<ul>
<li><p>闭包实现</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">local</span> x = <span class="number">20</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Foo</span><span class="params">(x)</span></span></span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span><span class="params">(y)</span></span></span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">string</span>.<span class="built_in">format</span>(<span class="string">&quot;2=======&gt; x: %d&quot;</span>, x))</span><br><span class="line">        <span class="keyword">return</span> x + y</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Bar</span><span class="params">()</span></span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Bar&quot;</span>)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">foo = Foo(x)</span><br><span class="line">x = <span class="number">30</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">string</span>.<span class="built_in">format</span>(<span class="string">&quot;1=======&gt; x: %d&quot;</span>, x))</span><br><span class="line"><span class="built_in">print</span>(foo(<span class="number">10</span>))</span><br></pre></td></tr></table></figure>

  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">输出：</span><br><span class="line">1=======&gt; x: 30</span><br><span class="line">2=======&gt; x: 20</span><br><span class="line">30</span><br><span class="line">[Finished in 58ms]</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p><code>table</code> 表</p>
<p><code>Lua</code> 中的表（<code>table</code>）其实是一个”关联数组”（<code>associative arrays</code>），数组的索引可以是数字、字符串或表类型。在 <code>Lua</code> 里，<code>table</code> 的创建是通过”构造表达式”来完成，最简单构造表达式是<code>&#123;&#125;</code>，用来创建一个空表。</p>
</li>
<li><p><code>userdata</code> 数据结构</p>
<p>表示任意存储在变量中的C数据结构</p>
</li>
<li><p><code>thread</code> 协同程序</p>
<p>表示执行的独立线路，用于执行协同程序</p>
</li>
</ul>
<h3 id="面向对象"><a href="#面向对象" class="headerlink" title="面向对象"></a>面向对象</h3><h4 id="面向对象特征"><a href="#面向对象特征" class="headerlink" title="面向对象特征"></a>面向对象特征</h4><ul>
<li>封装：能够把一个实体的信息、功能、响应等都装入一个单独的对象中</li>
<li>继承：继承的方法允许在不改动原程序的基础上对其进行扩充，这样使得原功能得以保存，而新功能也得以扩展。这有利于减少重复代码，提高软件开发效率</li>
<li>多态：同一操作作用于不同的对象，可以有不同的解释，产生不同的执行结果。在运行时，可以通过指向基类的指针来调用实现派生类中的方法。</li>
<li>抽象：抽象（<code>Abstraction</code>）是简化复杂的实现问题的途径，它可以为具体问题找到最恰当的类定义，并且可以在最恰当的继承级别解释问题</li>
</ul>
<h4 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h4><ul>
<li><p><code>LUA</code>中的类可以通过 <code>table</code> + <code>function</code> 模拟，继承可以通过 <code>metetable</code> 模拟</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">Rectangle = &#123;area = <span class="number">0</span>, length = <span class="number">0</span>, breadth = <span class="number">0</span>&#125;</span><br><span class="line"><span class="comment">-- 派生类的方法 new</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Rectangle:new</span> <span class="params">(o, length, breadth)</span></span></span><br><span class="line">    o = o <span class="keyword">or</span> &#123;&#125;</span><br><span class="line">    <span class="built_in">setmetatable</span>(o, <span class="built_in">self</span>)</span><br><span class="line">    <span class="built_in">self</span>.<span class="built_in">__index</span> = <span class="built_in">self</span>;</span><br><span class="line">    <span class="built_in">self</span>.length = length <span class="keyword">or</span> <span class="number">0</span></span><br><span class="line">    <span class="built_in">self</span>.breadth = breadth <span class="keyword">or</span> <span class="number">0</span></span><br><span class="line">    <span class="built_in">self</span>.area = length * breadth;</span><br><span class="line">    <span class="keyword">return</span> o;</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Rectangle:printArea</span><span class="params">()</span></span></span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">string</span>.<span class="built_in">format</span>(<span class="string">&quot;矩形面积为：%d&quot;</span>, <span class="built_in">self</span>.area))</span><br><span class="line"><span class="keyword">end</span> </span><br><span class="line"></span><br><span class="line">r = Rectangle:new(<span class="literal">nil</span>, <span class="number">10</span>, <span class="number">20</span>)</span><br><span class="line">r:printArea()</span><br></pre></td></tr></table></figure>


</li>
<li><p>继承</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">Shape = &#123; area = <span class="number">0</span> &#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Shape:new</span><span class="params">(o, side)</span></span></span><br><span class="line">    o = o <span class="keyword">or</span> &#123;&#125;</span><br><span class="line">    <span class="built_in">setmetatable</span>(o, <span class="built_in">self</span>)</span><br><span class="line">    <span class="built_in">self</span>.<span class="built_in">__index</span> = <span class="built_in">self</span></span><br><span class="line">    side = side <span class="keyword">or</span> <span class="number">0</span></span><br><span class="line">    <span class="built_in">self</span>.area = side * side</span><br><span class="line">    <span class="keyword">return</span> o</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Shape:printArea</span><span class="params">()</span></span></span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">string</span>.<span class="built_in">format</span>(<span class="string">&quot;面积为：%d&quot;</span>, <span class="built_in">self</span>.area))</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">myShape = Shape:new(<span class="literal">nil</span>, <span class="number">10</span>)</span><br><span class="line">myShape:printArea()</span><br><span class="line"></span><br><span class="line">Square = Shape:new()</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Square:new</span><span class="params">(o, side)</span></span></span><br><span class="line">    o = o <span class="keyword">or</span> Shape:new(o, side)</span><br><span class="line">    <span class="built_in">setmetatable</span>(o, <span class="built_in">self</span>)</span><br><span class="line">    <span class="built_in">self</span>.<span class="built_in">__index</span> = <span class="built_in">self</span></span><br><span class="line">    <span class="keyword">return</span> o</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 重写函数</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Square:printArea</span><span class="params">()</span></span></span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">string</span>.<span class="built_in">format</span>(<span class="string">&quot;正方形面积为：%d&quot;</span>, <span class="built_in">self</span>.area))</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">mySquare = Square:new(<span class="literal">nil</span>, <span class="number">15</span>)</span><br><span class="line">mySquare:printArea()</span><br><span class="line"></span><br><span class="line">Rectangle = Shape:new()</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Rectangle:new</span><span class="params">(o, length, breadth)</span></span></span><br><span class="line">    o = o <span class="keyword">or</span> Shape:new(o)</span><br><span class="line">    <span class="built_in">setmetatable</span>(o, <span class="built_in">self</span>)</span><br><span class="line">    <span class="built_in">self</span>.<span class="built_in">__index</span> = <span class="built_in">self</span></span><br><span class="line">    <span class="built_in">self</span>.area = length * breadth</span><br><span class="line">    <span class="keyword">return</span> o</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 重写函数</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Rectangle:printArea</span><span class="params">()</span></span></span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">string</span>.<span class="built_in">format</span>(<span class="string">&quot;矩形面积为：%d&quot;</span>, <span class="built_in">self</span>.area))</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">myRectangle = Rectangle:new(<span class="literal">nil</span>, <span class="number">10</span>, <span class="number">20</span>)</span><br><span class="line">myRectangle:printArea()</span><br></pre></td></tr></table></figure>


</li>
<li><p><code>.</code> 与 <code>:</code> 的区别在于使用 <code>:</code> 定义的函数隐含 <code>self</code> 参数，使用 <code>:</code> 调用函数会自动传入 <code>table</code> 至 <code>self</code> 参数</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">local</span> person = &#123;</span><br><span class="line">    name = <span class="string">&quot;Alice&quot;</span>,</span><br><span class="line">    greet = <span class="function"><span class="keyword">function</span><span class="params">(self)</span></span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Hello, &quot;</span> .. <span class="built_in">self</span>.name)</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">person:greet()  <span class="comment">-- 输出 &quot;Hello, Alice&quot;</span></span><br><span class="line">person.greet(person)  <span class="comment">-- 输出 &quot;Hello, Alice&quot;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ul>

    </div>
    <!--畅言PC和WAP自适应版-->
  
</div></div>
    </div>
    <div id="footer">雄关漫道真如铁 而今迈步从头越</div>
    <img id="top" src="/images/up-circle.svg" alt="top" />
    
  </body>
</html>
<!-- 加载主题脚本文件 -->

<script src="/scripts/utone.js"></script>


<script type="text/javascript">
  window.onload = function() {
    scroll.init()
    siteSearch.init()
  }
</script>
